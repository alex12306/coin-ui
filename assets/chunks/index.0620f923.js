import{l as w,ad as x,ae as M,g as l,x as O,h as y,af as T,j as $,ag as V,d as k,o as z,b as D,w as I,ah as h,k as g,n as b,N as j,t as A,ai as N,T as E,H as L,aj as S}from"./framework.e8ca29b5.js";function W(e){return x()?(M(e),!0):!1}function H(e){return typeof e=="function"?e():w(e)}const P=typeof window<"u"&&typeof document<"u";function B(e){var s;const n=H(e);return(s=n==null?void 0:n.$el)!=null?s:n}const q=P?window:void 0;function F(){const e=y(!1);return T()&&$(()=>{e.value=!0}),e}function G(e){const s=F();return l(()=>(s.value,!!e()))}function J(e,s,n={}){const{window:t=q,...a}=n;let o;const c=G(()=>t&&"ResizeObserver"in t),d=()=>{o&&(o.disconnect(),o=void 0)},f=l(()=>Array.isArray(e)?e.map(r=>B(r)):[B(e)]),C=O(f,r=>{if(d(),c.value&&t){o=new ResizeObserver(s);for(const v of r)v&&o.observe(v,a)}},{immediate:!0,flush:"post",deep:!0}),p=()=>{d(),C()};return W(p),{isSupported:c,stop:p}}const u=V([]),K=e=>{const s=u.findIndex(t=>t.id===e);let n;return s>0&&(n=u[s-1]),n},Q=e=>{const s=K(e);return s?s.VNode.component.exposed.bottom.value+15:15},U=e=>{var s,n,t;const a=u.findIndex(o=>o.id===e);(t=(n=(s=u[a].VNode)==null?void 0:s.props)==null?void 0:n.onClose)==null||t.call(n),a>=0&&u.splice(a,1)},X=["id"],Y=k({name:"CMessage",__name:"message",props:{id:{},message:{default:""},type:{default:"info"},showClose:{type:Boolean,default:!1},onClose:{},duration:{default:2e3}},setup(e,{expose:s}){const n=e,t=y(),a=y(0),o=y(!1);$(()=>{o.value=!0,n.duration!=0&&setTimeout(()=>{c()},n.duration)});function c(){o.value=!1}const d=["success","warning","info","error"];let f="iconfont";const C=l(()=>{let i="c-message";return i+=d.includes(n.type)?` c-message-${n.type}`:" c-message-info",f+=` icon-${n.type}`,i}),p=l(()=>Q(n.id)),r=l(()=>p.value),v=l(()=>a.value+r.value),R=l(()=>({top:`${r.value}px`}));return J(t,()=>{a.value=t.value.getBoundingClientRect().height}),s({bottom:v}),(i,m)=>(z(),D(E,{name:"message",onBeforeLeave:m[0]||(m[0]=_=>w(U)(i.id)),onAfterLeave:m[1]||(m[1]=_=>i.$emit("destroy"))},{default:I(()=>[h(g("div",{id:i.id,class:b(C.value),ref_key:"messageRef",ref:t,style:j(R.value)},[g("i",{class:b(w(f))},null,2),g("p",null,A(i.message),1),h(g("i",{class:"iconfont icon-close c-message-closeButton",onClick:c},null,512),[[N,i.showClose]])],14,X),[[N,o.value]])]),_:1}))}});let Z=1;const se=e=>{let s;e.constructor===String?s={message:e}:e.constructor===Object?s=e:s={};const n=document.body,t=document.createElement("div"),a=`message_${Z++}`,o=L(Y,{id:a,...s,onDestroy:()=>{S(null,t)}});S(o,t),n.appendChild(t.firstElementChild),u.push({id:a,VNode:o})};export{se as C};
